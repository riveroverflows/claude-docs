# CLAUDE.md 작성 가이드 (공식 문서 기반)

## CLAUDE.md란?

- Claude Code가 **매 세션 시작 시 자동으로 로딩**하는 파일
- Claude가 **코드를 읽어서는 알 수 없는 정보**를 전달하는 것이 목적
- 매번 로딩되므로 **토큰 비용에 직접 영향** → 간결할수록 좋음

## 핵심 원칙

> "각 줄마다 자문하라: 이걸 빼면 Claude가 실수할까? 아니라면 삭제하라."

- **~500줄 이하** 유지 권장
- 길어지면 Claude가 중요한 규칙을 무시하게 됨
- 코드처럼 정기적으로 리뷰하고 pruning 필요

## 넣어야 할 것

| 항목 | 예시 |
|------|------|
| Claude가 추측할 수 없는 빌드/테스트 명령어 | `./gradlew ktlintCheck`, `make init` |
| 기본 관례와 **다른** 코드 스타일 규칙 | "DTO는 inner class로 작성" |
| 저장소 규칙 (브랜치, PR, 커밋 관례) | "feature/ 접두사 필수" |
| 프로젝트 고유 아키텍처 결정사항 | "Hexagonal Architecture, Facade 패턴 사용" |
| 환경 설정 주의사항, 비직관적 동작 | "테스트는 maxParallelForks=1" |
| 모듈 간 의존성 규칙 | "domain 레이어는 외부 의존성 없음" |

## 넣지 말아야 할 것

| 항목 | 이유 |
|------|------|
| 코드를 읽으면 알 수 있는 것 | Claude가 직접 파악 가능 |
| 표준 언어/프레임워크 관례 | Claude가 이미 알고 있음 (Kotlin 네이밍 등) |
| 상세 API 문서 | 링크나 `@import`로 대체 |
| 자주 바뀌는 정보 | 유지보수 부담, 불일치 발생 |
| 파일별/클래스별 상세 설명 | 코드 자체가 문서 역할 |
| "깔끔한 코드를 작성하라" 같은 자명한 규칙 | 토큰 낭비 |
| 긴 튜토리얼이나 설명문 | 불릿 포인트로 압축 |

## README.md 내용은?

**중복하지 말 것.** `@` import 구문으로 참조:

```markdown
@README.md

# 추가 개발 규칙
- ...
```

단, import하면 그만큼 토큰을 소비하므로, README.md 전체를 import하기보다 **Claude에게 필요한 부분만** CLAUDE.md에 직접 작성하는 것이 효율적일 수 있음.

## 권장 구조

```markdown
# 프로젝트명

## Tech Stack (Claude가 추론 불가한 것만)
- 언어, 프레임워크, 주요 라이브러리 버전

## 모듈 구조 (간략)
- 모듈 간 의존성 규칙
- 핵심 패키지 구조

## 빌드 & 테스트 명령어
- 빌드, 테스트, 린트 커맨드

## 아키텍처 규칙
- 레이어 의존성 방향
- 핵심 패턴 (Facade, Hexagonal 등)

## 코드 컨벤션 (기본과 다른 것만)
- 네이밍 규칙
- DTO 패턴
- 테스트 작성 규칙

## 개발 워크플로우
- TDD 프로세스
- 커밋/PR 규칙
```

## CLAUDE.md 4가지 스코프

| 스코프 | 위치 | 용도 | 공유 범위 |
|--------|------|------|-----------|
| 프로젝트 | `./CLAUDE.md` | 팀 규칙 | git으로 팀 전체 |
| 프로젝트 로컬 | `./CLAUDE.local.md` | 개인 프로젝트 설정 | 본인만 (gitignore) |
| 사용자 | `~/.claude/CLAUDE.md` | 모든 프로젝트 공통 | 본인만 |
| 조직 정책 | 시스템 경로 | 조직 표준 | 조직 전체 |

**팁**: 팀원 모두에게 적용할 규칙 → `./CLAUDE.md`, 개인 선호 → `./CLAUDE.local.md`

## 안티패턴

1. **과도한 길이**: 규칙이 많을수록 무시당할 확률 증가
2. **README 복붙**: 중복 정보는 토큰 낭비 + 불일치 위험
3. **자명한 규칙**: "SOLID 원칙을 따르라" → Claude가 이미 알고 있음
4. **상세 설명문**: 단락 대신 불릿 포인트 사용
5. **변경 잦은 정보**: 버전, 상태 등 → 코드에서 읽게 하라

## 체크리스트

CLAUDE.md 작성 후 각 항목을 점검:

- [ ] 500줄 이하인가?
- [ ] 모든 항목이 "빼면 Claude가 실수하는" 정보인가?
- [ ] 코드에서 읽을 수 있는 정보를 중복하지 않았는가?
- [ ] 마크다운 헤딩과 불릿으로 스캔하기 쉬운가?
- [ ] 자명한 규칙(표준 관례)을 포함하지 않았는가?
- [ ] 빌드/테스트 명령어가 정확한가?
- [ ] 팀 규칙 vs 개인 설정이 올바른 스코프에 있는가?
